{% load humanize %}
<!DOCTYPE html>
<html class="light" lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Warung Kelontong - Dashboard Overview</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com" rel="preconnect"/>
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#137fec",
                        "background-light": "#f6f7f8",
                        "background-dark": "#101922",
                    },
                    fontFamily: {
                        "display": ["Inter", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.375rem", 
                        "lg": "0.5rem", 
                        "xl": "0.75rem", 
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
    <script>
        (function() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            const htmlElement = document.documentElement;
            if (savedTheme === 'dark') {
                htmlElement.classList.add('dark');
            } else if (savedTheme === 'system') {
                if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    htmlElement.classList.add('dark');
                }
            } else {
                htmlElement.classList.remove('dark');
            }
        })();
    </script>
</head>
<body class="bg-background-light dark:bg-background-dark font-display text-[#111418] dark:text-white antialiased">
<div class="relative flex h-auto min-h-screen w-full flex-col overflow-x-hidden">
<header class="sticky top-0 z-50 flex items-center justify-between whitespace-nowrap border-b border-solid border-[#e5e7eb] dark:border-[#2a3441] bg-white dark:bg-[#111a22] px-10 py-3 shadow-sm">
<div class="flex items-center gap-4">
<div class="size-8 text-primary">
<span class="material-symbols-outlined text-3xl">storefront</span>
</div>
<h2 class="text-[#111418] dark:text-white text-lg font-bold leading-tight tracking-[-0.015em]">Toko Kelontong Eni</h2>
</div>
<div class="flex flex-1 justify-end gap-8">
<div class="hidden md:flex items-center gap-9">
<a class="text-primary font-bold text-sm leading-normal" href="{% url 'dashboard' %}">Dashboard</a>
<a class="text-[#111418] dark:text-gray-300 text-sm font-medium leading-normal hover:text-primary transition-colors" href="{% url 'gudang' %}">Gudang</a>
<a class="text-[#111418] dark:text-gray-300 text-sm font-medium leading-normal hover:text-primary transition-colors" href="{% url 'transaksi' %}">Transaksi</a>
<a class="text-[#111418] dark:text-gray-300 text-sm font-medium leading-normal hover:text-primary transition-colors" href="{% url 'settings' %}">Pengaturan</a>
</div>
<div class="flex items-center gap-4">
<a href="{% url 'profile' request.session.ID %}">
<div class="user-avatar-target bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10 border-2 border-primary/20" style="background-image: url('{{ request.session.foto|default:'/static/img/default-avatar.png' }}');"  data-alt="Admin User Profile Picture"></div>
</a>
</div>
</div>
</header>

<div class="layout-container flex h-full grow flex-col">
<div class="px-4 md:px-10 lg:px-40 flex flex-1 justify-center py-5">
<div class="layout-content-container flex flex-col max-w-[960px] flex-1">
<div class="flex flex-wrap justify-between gap-3 p-4 mb-4">
<div class="flex min-w-72 flex-col gap-1">
<p class="text-[#111418] dark:text-white text-3xl md:text-4xl font-black leading-tight tracking-[-0.033em]">Tampilan Dashboard</p>
<p class="text-[#617589] dark:text-gray-400 text-base font-normal leading-normal">Selamat datang kembali, {{ request.session.hak }} {{ request.session.username }}</p>
</div>
</div>
<div class="grid grid-cols-1 md:grid-cols-3 gap-4 p-4">
<div class="flex flex-1 flex-col gap-2 rounded-xl p-6 border border-[#dbe0e6] dark:border-[#2a3441] bg-white dark:bg-[#1a2632] shadow-sm hover:shadow-md transition-shadow">
<div class="flex items-center justify-between">
<p class="text-[#111418] dark:text-gray-200 text-base font-medium leading-normal">Total Nilai Gudang</p>
<span class="material-symbols-outlined text-primary text-2xl">payments</span>
</div>
<p class="text-[#111418] dark:text-white tracking-light text-3xl font-bold leading-tight">Rp {{ total_aset|intcomma }}</p>
</div>

{% if stok_rendah_count > 0 %}
<div class="flex flex-1 flex-col gap-2 rounded-xl p-6 border border-red-200 dark:border-red-900 bg-red-50 dark:bg-[#321a1a] shadow-sm relative overflow-hidden">
<div class="absolute right-0 top-0 p-4 opacity-10">
<span class="material-symbols-outlined text-red-600 text-8xl">warning</span>
</div>
<div class="flex items-center justify-between z-10">
<p class="text-[#111418] dark:text-red-100 text-base font-medium leading-normal">Peringatan Stok Rendah</p>
<span class="material-symbols-outlined text-red-600 dark:text-red-400 text-2xl">warning</span>
</div>
<p class="text-[#111418] dark:text-white tracking-light text-2xl font-bold leading-tight z-10">{{ stok_rendah_count }} Barang</p>
<p class="text-red-700 dark:text-red-300 text-sm font-medium leading-normal z-10">Diperlukan pengisian stok segera</p>
</div>
{% else %}
<div class="flex flex-1 flex-col gap-2 rounded-xl p-6 border border-[#dbe0e6] dark:border-[#2a3441] bg-white dark:bg-[#1a2632] shadow-sm hover:shadow-md transition-shadow">
<div class="flex items-center justify-between">
<p class="text-[#111418] dark:text-gray-200 text-base font-medium leading-normal">Kondisi Stok</p>
<span class="material-symbols-outlined text-primary text-2xl">check_circle</span>
</div>
<p class="text-[#111418] dark:text-white tracking-light text-2xl font-bold leading-tight">Stok Tercukupi</p>
</div>
{% endif %}

<div class="flex flex-1 flex-col gap-2 rounded-xl p-6 border border-[#dbe0e6] dark:border-[#2a3441] bg-white dark:bg-[#1a2632] shadow-sm hover:shadow-md transition-shadow">
<div class="flex items-center justify-between">
<p class="text-[#111418] dark:text-gray-200 text-base font-medium leading-normal">Jumlah Total Barang</p>
<span class="material-symbols-outlined text-primary text-2xl">inventory_2</span>
</div>
<p class="text-[#111418] dark:text-white tracking-light text-3xl font-bold leading-tight">{{ daftarBarang|length }}</p>
</div>
</div>

<div>
<div class="px-4 pb-2 pt-6">
<h3 class="text-[#111418] dark:text-white text-lg font-bold leading-tight tracking-[-0.015em]">Quick Actions</h3>
</div>
<div class="flex flex-wrap gap-4 px-4 py-3 justify-start">
<a href="{% url 'tambah_transaksi' %}">
<button class="flex min-w-[84px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-12 px-6 bg-primary text-white gap-2 text-base font-bold leading-normal tracking-[0.015em] hover:bg-blue-600 transition-colors shadow-sm">
<span class="material-symbols-outlined text-2xl">add_circle</span>
<span class="truncate">Tambah Barang</span>
</button>
</a>
<a href="{% url 'gudang' %}">
<button class="flex min-w-[84px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-12 px-6 bg-white dark:bg-[#2a3441] border border-[#dbe0e6] dark:border-[#344050] text-[#111418] dark:text-white gap-2 text-base font-bold leading-normal tracking-[0.015em] hover:bg-gray-50 dark:hover:bg-[#344050] transition-colors shadow-sm">
<span class="material-symbols-outlined text-2xl text-[#617589] dark:text-gray-300">list_alt</span>
<span class="truncate">Lihat barang digudang</span>
</button>
</a>
<a href="{% url 'transaksi' %}">
<button class="flex min-w-[84px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-12 px-6 bg-white dark:bg-[#2a3441] border border-[#dbe0e6] dark:border-[#344050] text-[#111418] dark:text-white gap-2 text-base font-bold leading-normal tracking-[0.015em] hover:bg-gray-50 dark:hover:bg-[#344050] transition-colors shadow-sm">
<span class="material-symbols-outlined text-2xl text-[#617589] dark:text-gray-300">point_of_sale</span>
<span class="truncate">Transaksi Baru</span>
</button>
</a>
</div>

<div class="p-4 mt-4">
<div class="flex flex-col md:flex-row rounded-xl border border-[#dbe0e6] dark:border-[#2a3441] bg-white dark:bg-[#1a2632] overflow-hidden shadow-sm">
<div class="md:w-1/3 h-48 md:h-auto bg-cover bg-center" style='background-image: url("https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?q=80&w=2070&auto=format&fit=crop");'>
</div>
<div class="flex-1 p-6 flex flex-col justify-between">
<div class="flex justify-between items-start mb-4">
<div>
<h4 class="text-[#111418] dark:text-white text-xl font-bold mb-1">Main Warung Storage</h4>
<p class="text-[#617589] dark:text-gray-400 text-sm">Location: Jakarta Selatan, Indonesia</p>
</div>
<span class="px-3 py-1 rounded-full bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 text-xs font-bold uppercase tracking-wider">Active</span>
</div>
<div class="grid grid-cols-2 gap-4 mb-6">
<div>
<p class="text-[#617589] dark:text-gray-500 text-xs font-semibold uppercase tracking-wider mb-1">Description</p>
<p class="text-[#111418] dark:text-gray-200 text-sm">Penyimpanan utama barang dagangan.</p>
</div>
</div>
<div class="flex items-center gap-2 pt-4 border-t border-[#f0f2f4] dark:border-[#2a3441]">
<span class="text-sm text-[#617589] dark:text-gray-400">3 Staff members assigned</span>
<a href="{% url 'manage' %}" class="ml-auto text-primary text-sm font-bold hover:underline">Manage Details</a>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const savedAvatar = localStorage.getItem('userAvatar');
        if (savedAvatar) {
            document.querySelectorAll('.user-avatar-target').forEach(el => {
                el.style.backgroundImage = `url('${savedAvatar}')`;
            });
        }
    });
</script>
</body>
</html>